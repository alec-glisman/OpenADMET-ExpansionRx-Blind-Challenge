<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Hyperparameter Optimization Guide" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://github.com/alec-glisman/guide/hpo.html" />
<meta property="og:site_name" content="OpenADMET Challenge" />
<meta property="og:description" content="This guide covers hyperparameter optimization (HPO) for Chemprop models using Ray Tune with the ASHA scheduler. HPO enables systematic exploration of model configurations to find optimal hyperparam..." />
<meta property="og:image" content="https://github.com/alec-glisman/_static/images/logo.svg" />
<meta property="og:image:alt" content="OpenADMET Challenge" />
<meta name="description" content="This guide covers hyperparameter optimization (HPO) for Chemprop models using Ray Tune with the ASHA scheduler. HPO enables systematic exploration of model configurations to find optimal hyperparam..." />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Curriculum Learning Guide" href="curriculum.html"><link rel="prev" title="Modeling Guide" href="modeling.html">
        <link rel="prefetch" href="../_static/logo.svg" as="image">

    <link rel="shortcut icon" href="../_static/logo.svg"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Hyperparameter Optimization Guide - OpenADMET Challenge</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.min.css?v=21c0b90a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #007A73;
  --color-brand-content: #C4C7F2;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #007A73;
  --color-brand-content: #C4C7F2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #007A73;
  --color-brand-content: #C4C7F2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">OpenADMET Challenge</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/admet.html">ADMET Package API</a><input aria-label="Toggle navigation of ADMET Package API" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/admet.data.html">Data Pipeline (<code class="docutils literal notranslate"><span class="pre">admet.data</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/admet.model.html">Model Package (<code class="docutils literal notranslate"><span class="pre">admet.model</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/admet.plot.html">Visualization Tools (<code class="docutils literal notranslate"><span class="pre">admet.plot</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/admet.util.html">Utilities (<code class="docutils literal notranslate"><span class="pre">admet.util</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_sources.html">Data Sources &amp; Curation</a></li>
<li class="toctree-l1"><a class="reference internal" href="splitting.html">Dataset Splitting Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_reference.html">Configuration File Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling Guide</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Hyperparameter Optimization Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="curriculum.html">Curriculum Learning Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_affinity.html">Task Affinity Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="mlflow_artifacts.html">MLflow Artifacts Guide</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/guide/hpo.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="hyperparameter-optimization-guide">
<h1>Hyperparameter Optimization Guide<a class="headerlink" href="#hyperparameter-optimization-guide" title="Link to this heading">¶</a></h1>
<p>This guide covers hyperparameter optimization (HPO) for Chemprop models using
Ray Tune with the ASHA scheduler. HPO enables systematic exploration of model
configurations to find optimal hyperparameters for your ADMET prediction tasks.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The HPO system provides:</p>
<ul class="simple">
<li><p><strong>Ray Tune Integration</strong>: Distributed hyperparameter search with efficient scheduling</p></li>
<li><p><strong>ASHA Scheduler</strong>: Asynchronous successive halving for early stopping of poor trials</p></li>
<li><p><strong>MLflow Tracking</strong>: Automatic logging of trial results and best configurations</p></li>
<li><p><strong>Checkpoint Recovery</strong>: Trial checkpoints for fault tolerance</p></li>
<li><p><strong>Comprehensive Metrics</strong>: Validation MAE, RMSE, R², Pearson r, Spearman ρ</p></li>
</ul>
</section>
<section id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading">¶</a></h2>
<p>Run HPO using the CLI:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>admet.model.chemprop.hpo<span class="w"> </span>--config<span class="w"> </span>configs/1-hpo-single/hpo_chemprop.yaml
</pre></div>
</div>
<p>Or programmatically:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">admet.model.chemprop.hpo</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChempropHPO</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">omegaconf</span><span class="w"> </span><span class="kn">import</span> <span class="n">OmegaConf</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">OmegaConf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;configs/1-hpo-single/hpo_chemprop.yaml&quot;</span><span class="p">)</span>
<span class="n">hpo</span> <span class="o">=</span> <span class="n">ChempropHPO</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">best_config</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">hpo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best validation MAE: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">best_result</span><span class="p">[</span><span class="s1">&#39;val_mae&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>HPO is configured through a YAML file with the following sections:</p>
<section id="data-configuration">
<h3>Data Configuration<a class="headerlink" href="#data-configuration" title="Link to this heading">¶</a></h3>
<p>Specify training and validation data paths:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data paths</span>
<span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/dataset/split_train_val/v3/train.csv</span>
<span class="nt">val_data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/dataset/split_train_val/v3/val.csv</span>

<span class="c1"># Column configuration</span>
<span class="nt">smiles_column</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SMILES</span>
<span class="nt">target_columns</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;LogD&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Log</span><span class="nv"> </span><span class="s">KSOL&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Log</span><span class="nv"> </span><span class="s">HLM</span><span class="nv"> </span><span class="s">CLint&quot;</span>
</pre></div>
</div>
</section>
<section id="search-space-configuration">
<h3>Search Space Configuration<a class="headerlink" href="#search-space-configuration" title="Link to this heading">¶</a></h3>
<p>Define hyperparameter distributions for optimization:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">search_space</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Learning rate (log-uniform for wide range)</span>
<span class="w">  </span><span class="nt">learning_rate</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">loguniform</span>
<span class="w">    </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e-5</span>
<span class="w">    </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e-2</span>

<span class="w">  </span><span class="c1"># Learning rate schedule parameters</span>
<span class="w">  </span><span class="nt">lr_warmup_ratio</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uniform</span>
<span class="w">    </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.01</span>
<span class="w">    </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>

<span class="w">  </span><span class="nt">lr_final_ratio</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uniform</span>
<span class="w">    </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.01</span>
<span class="w">    </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>

<span class="w">  </span><span class="c1"># Regularization</span>
<span class="w">  </span><span class="nt">dropout</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uniform</span>
<span class="w">    </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
<span class="w">    </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>

<span class="w">  </span><span class="c1"># Message passing architecture</span>
<span class="w">  </span><span class="nt">depth</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">message_hidden_dim</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">512</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1024</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="c1"># FFN architecture</span>
<span class="w">  </span><span class="nt">ffn_num_layers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">ffn_hidden_dim</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">512</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">768</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1024</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="c1"># Training</span>
<span class="w">  </span><span class="nt">batch_size</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">    </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">32</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">128</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Supported distribution types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uniform</span></code>: Uniform distribution between <code class="docutils literal notranslate"><span class="pre">low</span></code> and <code class="docutils literal notranslate"><span class="pre">high</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loguniform</span></code>: Log-uniform distribution (for learning rates)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quniform</span></code>: Quantized uniform distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">choice</span></code>: Categorical choice from <code class="docutils literal notranslate"><span class="pre">values</span></code> list</p></li>
</ul>
</section>
<section id="conditional-parameters">
<h3>Conditional Parameters<a class="headerlink" href="#conditional-parameters" title="Link to this heading">¶</a></h3>
<p>For architecture-specific parameters, use conditional sampling:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># FFN type selection</span>
<span class="nt">ffn_type</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">mlp</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">moe</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">branched</span><span class="p p-Indicator">]</span>

<span class="c1"># MoE-specific (only sampled when ffn_type=moe)</span>
<span class="nt">n_experts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">conditional_on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ffn_type</span>
<span class="w">  </span><span class="nt">conditional_values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">moe</span><span class="p p-Indicator">]</span>

<span class="c1"># Branched-specific (only sampled when ffn_type=branched)</span>
<span class="nt">trunk_depth</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">choice</span>
<span class="w">  </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">conditional_on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ffn_type</span>
<span class="w">  </span><span class="nt">conditional_values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">branched</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</section>
<section id="asha-scheduler-configuration">
<h3>ASHA Scheduler Configuration<a class="headerlink" href="#asha-scheduler-configuration" title="Link to this heading">¶</a></h3>
<p>Configure the ASHA scheduler for efficient early stopping:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">asha</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Metric to optimize</span>
<span class="w">  </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val_mae</span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">min</span><span class="w">  </span><span class="c1"># &#39;min&#39; for loss metrics, &#39;max&#39; for accuracy</span>

<span class="w">  </span><span class="c1"># Training epochs</span>
<span class="w">  </span><span class="nt">max_t</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">           </span><span class="c1"># Maximum epochs for full training</span>
<span class="w">  </span><span class="nt">grace_period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span><span class="w">     </span><span class="c1"># Minimum epochs before early stopping</span>

<span class="w">  </span><span class="c1"># Successive halving parameters</span>
<span class="w">  </span><span class="nt">reduction_factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class="w">  </span><span class="c1"># Keep top 1/3 of trials at each rung</span>
<span class="w">  </span><span class="nt">brackets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">          </span><span class="c1"># Number of brackets (1 is standard ASHA)</span>
</pre></div>
</div>
<p>Key parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_t</span></code>: Maximum training epochs for the best trials (default: 100)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grace_period</span></code>: Minimum epochs before a trial can be stopped (default: 15)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduction_factor</span></code>: Fraction of trials promoted at each rung (default: 3)</p></li>
</ul>
</section>
<section id="resource-configuration">
<h3>Resource Configuration<a class="headerlink" href="#resource-configuration" title="Link to this heading">¶</a></h3>
<p>Specify computational resources for HPO:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Number of HPO trials to run</span>
<span class="w">  </span><span class="nt">num_samples</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>

<span class="w">  </span><span class="c1"># Resources per trial</span>
<span class="w">  </span><span class="nt">cpus_per_trial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">gpus_per_trial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.25</span><span class="w">  </span><span class="c1"># 4 concurrent trials per GPU</span>

<span class="w">  </span><span class="c1"># Concurrency limit (null = auto based on resources)</span>
<span class="w">  </span><span class="nt">max_concurrent_trials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
</section>
<section id="per-target-weight-optimization">
<h3>Per-Target Weight Optimization<a class="headerlink" href="#per-target-weight-optimization" title="Link to this heading">¶</a></h3>
<p>For multi-task models, optimize per-endpoint loss weights:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">target_weights</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uniform</span>
<span class="w">  </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.05</span>
<span class="w">  </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50.0</span>
</pre></div>
</div>
<p>This samples a separate weight for each target column, allowing the optimizer
to balance learning across endpoints with different scales and difficulties.</p>
</section>
</section>
<section id="search-space-parameters">
<h2>Search Space Parameters<a class="headerlink" href="#search-space-parameters" title="Link to this heading">¶</a></h2>
<p>The following hyperparameters are available for optimization:</p>
<section id="learning-rate-parameters">
<h3>Learning Rate Parameters<a class="headerlink" href="#learning-rate-parameters" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 50.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Recommended Range</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code></p></td>
<td><p>Peak learning rate (max_lr)</p></td>
<td><p>1e-5 to 1e-2 (loguniform)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lr_warmup_ratio</span></code></p></td>
<td><p>init_lr = max_lr × warmup_ratio</p></td>
<td><p>0.01 to 0.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lr_final_ratio</span></code></p></td>
<td><p>final_lr = max_lr × final_ratio</p></td>
<td><p>0.01 to 0.2</p></td>
</tr>
</tbody>
</table>
</div>
<p>The learning rate follows a warmup-plateau-decay schedule:</p>
<ol class="arabic simple">
<li><p><strong>Warmup</strong>: Linear increase from <code class="docutils literal notranslate"><span class="pre">init_lr</span></code> to <code class="docutils literal notranslate"><span class="pre">max_lr</span></code></p></li>
<li><p><strong>Plateau</strong>: Constant at <code class="docutils literal notranslate"><span class="pre">max_lr</span></code> for most of training</p></li>
<li><p><strong>Decay</strong>: Cosine decay from <code class="docutils literal notranslate"><span class="pre">max_lr</span></code> to <code class="docutils literal notranslate"><span class="pre">final_lr</span></code></p></li>
</ol>
</section>
<section id="architecture-parameters">
<h3>Architecture Parameters<a class="headerlink" href="#architecture-parameters" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 50.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Recommended Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">depth</span></code></p></td>
<td><p>Number of message passing layers</p></td>
<td><p>3, 4, 5, 6</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">message_hidden_dim</span></code></p></td>
<td><p>MPNN hidden layer width</p></td>
<td><p>256, 512, 768, 1024</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ffn_num_layers</span></code></p></td>
<td><p>Number of FFN layers</p></td>
<td><p>1, 2, 3</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ffn_hidden_dim</span></code></p></td>
<td><p>FFN hidden layer width</p></td>
<td><p>256, 512, 768, 1024</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dropout</span></code></p></td>
<td><p>Dropout rate</p></td>
<td><p>0.0 to 0.4</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="ffn-type-parameters">
<h3>FFN Type Parameters<a class="headerlink" href="#ffn-type-parameters" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 50.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ffn_type</span></code></p></td>
<td><p>Prediction head architecture</p></td>
<td><p>mlp, moe, branched</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n_experts</span></code></p></td>
<td><p>Number of experts (MoE only)</p></td>
<td><p>2, 4, 8</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">trunk_depth</span></code></p></td>
<td><p>Shared trunk layers (branched only)</p></td>
<td><p>1, 2, 3</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">trunk_hidden_dim</span></code></p></td>
<td><p>Trunk hidden width (branched only)</p></td>
<td><p>256, 512, 768</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="reported-metrics">
<h2>Reported Metrics<a class="headerlink" href="#reported-metrics" title="Link to this heading">¶</a></h2>
<p>Each trial reports comprehensive metrics for analysis:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Metric</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">val_mae</span></code></p></td>
<td><p>Validation Mean Absolute Error</p></td>
<td><p>Primary optimization metric</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">val_rmse</span></code></p></td>
<td><p>Validation Root Mean Square Error</p></td>
<td><p>Alternative error metric</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">val_R2</span></code></p></td>
<td><p>Validation R² score</p></td>
<td><p>Explained variance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">val_pearson_r</span></code></p></td>
<td><p>Validation Pearson correlation</p></td>
<td><p>Linear correlation strength</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">val_spearman_rho</span></code></p></td>
<td><p>Validation Spearman correlation</p></td>
<td><p>Rank correlation strength</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">train_mae</span></code></p></td>
<td><p>Training MAE</p></td>
<td><p>Overfitting detection</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">train_rmse</span></code></p></td>
<td><p>Training RMSE</p></td>
<td><p>Overfitting detection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">train_R2</span></code></p></td>
<td><p>Training R²</p></td>
<td><p>Overfitting detection</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">train_loss</span></code></p></td>
<td><p>Training loss</p></td>
<td><p>Learning progress</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">epoch</span></code></p></td>
<td><p>Current epoch</p></td>
<td><p>Training progress</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="checkpoint-recovery">
<h2>Checkpoint Recovery<a class="headerlink" href="#checkpoint-recovery" title="Link to this heading">¶</a></h2>
<p>Trials automatically save checkpoints for fault tolerance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checkpoints are saved in the trial directory</span>
<span class="c1"># Ray Tune handles automatic recovery on failure</span>

<span class="c1"># To resume a failed HPO run:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ray</span><span class="w"> </span><span class="kn">import</span> <span class="n">tune</span>

<span class="c1"># Restore from previous experiment</span>
<span class="n">tuner</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">Tuner</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;assets/models/chemprop/hpo/ray_results/experiment_name&quot;</span><span class="p">,</span>
    <span class="n">trainable</span><span class="o">=</span><span class="n">train_chemprop_trial</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="transfer-learning-workflow">
<h2>Transfer Learning Workflow<a class="headerlink" href="#transfer-learning-workflow" title="Link to this heading">¶</a></h2>
<p>After HPO, use the best configurations for full ensemble training:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">transfer_learning</span><span class="p">:</span>
<span class="w">  </span><span class="nt">top_k</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">           </span><span class="c1"># Number of top configurations to use</span>
<span class="w">  </span><span class="nt">full_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span><span class="w">     </span><span class="c1"># Full training epochs</span>
<span class="w">  </span><span class="nt">ensemble_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w">    </span><span class="c1"># Models per configuration</span>
</pre></div>
</div>
<p>Workflow:</p>
<ol class="arabic simple">
<li><p>Run HPO to find optimal hyperparameters</p></li>
<li><p>Select top-k configurations based on validation metrics</p></li>
<li><p>Train full ensemble models using each configuration</p></li>
<li><p>Combine predictions with uncertainty quantification</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">admet.model.chemprop.hpo</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChempropHPO</span>

<span class="c1"># Run HPO</span>
<span class="n">hpo</span> <span class="o">=</span> <span class="n">ChempropHPO</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">best_config</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">hpo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Get top-k configurations</span>
<span class="n">top_configs</span> <span class="o">=</span> <span class="n">hpo</span><span class="o">.</span><span class="n">get_top_configs</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Train ensemble with best config</span>
<span class="n">ensemble_config</span> <span class="o">=</span> <span class="n">top_configs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># ... proceed with ensemble training</span>
</pre></div>
</div>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<section id="search-space-design">
<h3>Search Space Design<a class="headerlink" href="#search-space-design" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Start broad, then narrow</strong>: Begin with wide ranges and refine based on results</p></li>
<li><p><strong>Use log-uniform for learning rates</strong>: Orders of magnitude matter more than linear differences</p></li>
<li><p><strong>Consider architecture interactions</strong>: Deeper networks may need different learning rates</p></li>
</ol>
</section>
<section id="resource-allocation">
<h3>Resource Allocation<a class="headerlink" href="#resource-allocation" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Balance trials vs. epochs</strong>: More short trials often beats fewer long trials</p></li>
<li><p><strong>Set appropriate grace_period</strong>: Allow enough epochs for learning rate warmup</p></li>
<li><p><strong>Use fractional GPUs</strong>: Run multiple trials per GPU for better utilization</p></li>
</ol>
</section>
<section id="monitoring">
<h3>Monitoring<a class="headerlink" href="#monitoring" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Watch for overfitting</strong>: Compare train vs. validation metrics</p></li>
<li><p><strong>Check correlation metrics</strong>: R², Pearson r, and Spearman ρ provide different insights</p></li>
<li><p><strong>Use MLflow UI</strong>: <code class="docutils literal notranslate"><span class="pre">mlflow</span> <span class="pre">ui</span> <span class="pre">--port</span> <span class="pre">5000</span></code> for interactive analysis</p></li>
</ol>
</section>
</section>
<section id="example-configurations">
<h2>Example Configurations<a class="headerlink" href="#example-configurations" title="Link to this heading">¶</a></h2>
<section id="minimal-hpo-configuration">
<h3>Minimal HPO Configuration<a class="headerlink" href="#minimal-hpo-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">experiment_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">minimal_hpo</span>
<span class="nt">data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/train.csv</span>
<span class="nt">val_data_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/val.csv</span>
<span class="nt">smiles_column</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SMILES</span>
<span class="nt">target_columns</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;LogD&quot;</span><span class="p p-Indicator">]</span>

<span class="nt">search_space</span><span class="p">:</span>
<span class="w">  </span><span class="nt">learning_rate</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">loguniform</span>
<span class="w">    </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e-4</span>
<span class="w">    </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e-2</span>

<span class="nt">asha</span><span class="p">:</span>
<span class="w">  </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">val_mae</span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">min</span>
<span class="w">  </span><span class="nt">max_t</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">  </span><span class="nt">grace_period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">num_samples</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gpus_per_trial</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
</pre></div>
</div>
</section>
<section id="production-hpo-configuration">
<h3>Production HPO Configuration<a class="headerlink" href="#production-hpo-configuration" title="Link to this heading">¶</a></h3>
<p>See <code class="docutils literal notranslate"><span class="pre">configs/1-hpo-single/hpo_chemprop.yaml</span></code> for a complete production configuration
with all available parameters.</p>
</section>
</section>
<section id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h2>
<p>See the API documentation for detailed class and function references:</p>
<ul class="simple">
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">admet.model.chemprop.hpo</span></code> - Main HPO orchestrator</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">admet.model.chemprop.hpo_config</span></code> - Configuration dataclasses</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">admet.model.chemprop.hpo_search_space</span></code> - Search space builders</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">admet.model.chemprop.hpo_trainable</span></code> - Ray Tune trainable function</p></li>
</ul>
</section>
<section id="cross-references">
<h2>Cross-References<a class="headerlink" href="#cross-references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>See <a class="reference internal" href="modeling.html"><span class="doc">Modeling Guide</span></a> for general modeling guide</p></li>
<li><p>See <a class="reference internal" href="configuration.html"><span class="doc">Configuration Guide</span></a> for configuration file format</p></li>
<li><p>See <a class="reference internal" href="splitting.html"><span class="doc">Dataset Splitting Methodology</span></a> for dataset preparation</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="curriculum.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Curriculum Learning Guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="modeling.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Modeling Guide</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Alec Glisman, Ph.D.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Hyperparameter Optimization Guide</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#data-configuration">Data Configuration</a></li>
<li><a class="reference internal" href="#search-space-configuration">Search Space Configuration</a></li>
<li><a class="reference internal" href="#conditional-parameters">Conditional Parameters</a></li>
<li><a class="reference internal" href="#asha-scheduler-configuration">ASHA Scheduler Configuration</a></li>
<li><a class="reference internal" href="#resource-configuration">Resource Configuration</a></li>
<li><a class="reference internal" href="#per-target-weight-optimization">Per-Target Weight Optimization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#search-space-parameters">Search Space Parameters</a><ul>
<li><a class="reference internal" href="#learning-rate-parameters">Learning Rate Parameters</a></li>
<li><a class="reference internal" href="#architecture-parameters">Architecture Parameters</a></li>
<li><a class="reference internal" href="#ffn-type-parameters">FFN Type Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reported-metrics">Reported Metrics</a></li>
<li><a class="reference internal" href="#checkpoint-recovery">Checkpoint Recovery</a></li>
<li><a class="reference internal" href="#transfer-learning-workflow">Transfer Learning Workflow</a></li>
<li><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li><a class="reference internal" href="#search-space-design">Search Space Design</a></li>
<li><a class="reference internal" href="#resource-allocation">Resource Allocation</a></li>
<li><a class="reference internal" href="#monitoring">Monitoring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-configurations">Example Configurations</a><ul>
<li><a class="reference internal" href="#minimal-hpo-configuration">Minimal HPO Configuration</a></li>
<li><a class="reference internal" href="#production-hpo-configuration">Production HPO Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-reference">API Reference</a></li>
<li><a class="reference internal" href="#cross-references">Cross-References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8a448e45"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    </body>
</html>