# Chemeleon Ensemble Configuration
# Trains an ensemble of Chemeleon foundation models with fine-tuning
#
# Run command:
#   admet model ensemble --config configs/4-more-models/chemeleon.yaml
#
# Note: Pretrained weights will be downloaded from Zenodo on first run (~500MB)

data:
  data_dir: assets/dataset/split_train_val/v3/quality_high/bitbirch/multilabel_stratified_kfold/data
  splits: null # Use all splits if null, or specify [0, 1, 2] for specific splits
  folds: null # Use all folds if null, or specify [0, 1, 2] for specific folds
  test_file: assets/dataset/set/local_test.csv
  blind_file: assets/dataset/set/blind_test.csv
  output_dir: null
  smiles_col: SMILES
  target_cols:
    - LogD
    - Log KSOL
    - Log HLM CLint
    - Log MLM CLint
    - Log Caco-2 Permeability Papp A>B
    - Log Caco-2 Permeability Efflux
    - Log MPPB
    - Log MBPB
    - Log MGMB

model:
  type: chemeleon
  chemeleon:
    zenodo_id: "12776282"
    zenodo_filename: "chemeleon.pt"
    model_cache_dir: models/chemeleon_cache
    unfreeze_encoder: true
    unfreeze_schedule:
      unfreeze_at_epoch: 10
      unfreeze_encoder_lr_multiplier: 0.1
    head:
      hidden_dims:
        - 256
        - 128
      dropout: 0.2
      activation: relu

optimization:
  max_epochs: 150
  patience: 15
  batch_size: 128
  learning_rate: 0.00113
  weight_decay: 0.0001
  num_workers: 0
  seed: 12345
  progress_bar: false
  scheduler:
    type: cosine
    warmup_epochs: 5

ray:
  max_parallel: 5
  num_cpus: null
  num_gpus: null

mlflow:
  tracking: true
  tracking_uri: http://127.0.0.1:8084
  experiment_name: ensemble_additional_models
  run_name: null
  nested: true
